  /* ====== Escopo do widget ====== */
  #wpp-widget { position: fixed; right: max(16px, env(safe-area-inset-right)); bottom: max(16px, env(safe-area-inset-bottom)); z-index: 9999; font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; }
  #wpp-widget, #wpp-widget * { box-sizing: border-box; }

  :root {
    --wpp: #25d366;
    --panel-bg: #0f1320;
    --panel-bd: rgba(255,255,255,.08);
    --txt: #e9edf3;
    --muted: #a9b1c0;
    --shadow: 0 18px 40px rgba(0,0,0,.35);
    --radius: 16px;
    --size: 64px;
  }

  /* Botão flutuante */
  .wpp-button{
    width: var(--size); height: var(--size);
    border-radius: 50%; border: none; cursor: pointer; position: relative;
    background: radial-gradient(120% 120% at 20% 20%, #2af375, var(--wpp));
    box-shadow: var(--shadow);
    display: grid; place-items: center;
    transition: transform .18s ease, box-shadow .18s ease, filter .18s ease;
    outline: none;
    will-change: transform;
  }
  .wpp-button:hover{ transform: translateY(-2px); filter: saturate(1.05); }
  .wpp-button:active{ transform: translateY(0); }
  .wpp-button:focus-visible{ outline: 3px solid rgba(255,255,255,.7); outline-offset: 3px; }

  /* Ícone como IMG */
  .wpp-ico-img{
    width: 28px; height: 28px; object-fit: contain; display: block;
  }

  /* Tooltip */
  .wpp-tooltip{
    position: absolute; right: calc(100% + 10px); top: 50%; transform: translateY(-50%) translateX(8px);
    background: #11131a; border: 1px solid var(--panel-bd); padding: 8px 10px; border-radius: 10px;
    color: var(--txt); font-size: 12px; white-space: nowrap; opacity: 0; pointer-events: none;
    transition: opacity .2s ease, transform .2s ease;
    box-shadow: var(--shadow);
  }
  .wpp-button:hover .wpp-tooltip{ opacity: 1; transform: translateY(-50%) translateX(0); }

  /* Ping e status */
  .wpp-ping{
    position:absolute; inset:0; border-radius:50%; pointer-events:none;
    animation: ping 2s infinite;
    background: radial-gradient(circle, rgba(255,255,255,.35) 0%, rgba(255,255,255,0) 60%);
    opacity: .3;
  }
  @keyframes ping{ 0%{ transform: scale(1); opacity:.35 } 70%{ transform: scale(1.5); opacity:0 } 100%{ opacity:0 } }
  .wpp-online{
    position:absolute; width:12px; height:12px; border-radius:50%; background:#22c55e; right:-2px; bottom:-2px; border:2px solid #0a0a0b;
    box-shadow: 0 0 0 2px rgba(34,197,94,.2);
  }

  /* Folha de ações */
  .wpp-sheet{
    position: absolute; right: 0; bottom: calc(var(--size) + 12px);
    width: min(92vw, 340px); background: var(--panel-bg); color: var(--txt);
    border: 1px solid var(--panel-bd); border-radius: var(--radius); box-shadow: var(--shadow);
    transform: translateY(8px); opacity: 0; pointer-events: none; transition: transform .2s ease, opacity .2s ease;
    overflow: hidden;
  }
  .wpp.open .wpp-sheet{ transform: translateY(0); opacity: 1; pointer-events: auto; }
  .wpp-sheet-head{
    display:flex; align-items:center; justify-content:space-between; padding:12px 12px; border-bottom: 1px solid var(--panel-bd);
    background: linear-gradient(180deg, rgba(255,255,255,.03), transparent);
  }
  .wpp-agent{ display:flex; align-items:center; gap:10px; }
  .wpp-agent-ava{ width:28px; height:28px; display:grid; place-items:center; border-radius:50%; background:#1a2134; }
  .wpp-agent-info strong{ display:block; font-size:14px; }
  .wpp-agent-info .typing{ display:inline-grid; grid-auto-flow:column; gap:3px; margin-top:3px; opacity:.7 }
  .typing i{ width:5px; height:5px; border-radius:50%; background:#cbd5e1; animation: dot 1.2s infinite; }
  .typing i:nth-child(2){ animation-delay:.15s } .typing i:nth-child(3){ animation-delay:.3s }
  @keyframes dot{ 0%,60%,100%{ transform: translateY(0) } 30%{ transform: translateY(-2px) } }

  .wpp-close{
    border:none; background:transparent; color:#d1d5db; font-size:16px; width:32px; height:32px; border-radius:8px; cursor:pointer;
  }
  .wpp-close:hover{ background: rgba(255,255,255,.05); }

  .wpp-quick{ display:grid; grid-template-columns:1fr 1fr 1fr; gap:8px; padding:12px; }
  .wpp-quick .q{
    background:#151a2a; color:#e5e7eb; border:1px solid var(--panel-bd); padding:10px 8px; border-radius:12px; font-weight:600; cursor:pointer;
    transition: transform .12s ease, background .12s ease, border-color .12s ease;
  }
  .wpp-quick .q:hover{ transform: translateY(-1px); background:#18203a; }
  .wpp-quick .q.active{ outline:2px solid rgba(37,211,102,.5); border-color: rgba(37,211,102,.4); }

  .wpp-actions{ display:grid; gap:8px; padding:0 12px 12px; }
  .wpp-cta{
    background: linear-gradient(135deg, #2af375, var(--wpp)); color:#0b0b0b; font-weight:800; border:none; border-radius:12px;
    padding:12px 14px; cursor:pointer; box-shadow: var(--shadow); transition: transform .12s ease, filter .12s ease;
  }
  .wpp-cta:hover{ transform: translateY(-1px); filter:saturate(1.05); }
  .wpp-alt{
    text-align:center; display:block; padding:10px 8px; border-radius:10px; color: var(--muted); text-decoration:none; border:1px dashed var(--panel-bd);
  }
  .wpp-alt:hover{ background: rgba(255,255,255,.04); }

  /* Efeito ripple (gerado via JS) */
  .wpp-ripple{
    position:absolute; border-radius:50%; transform: translate(-50%, -50%); pointer-events:none;
    width:8px; height:8px; background: rgba(255,255,255,.5); animation:ripple .5s ease forwards;
  }
  @keyframes ripple{ to{ width:120px; height:120px; opacity:0; } }

  /* Acessibilidade: reduz movimento */
  @media (prefers-reduced-motion: reduce){
    .wpp-ping, .typing i{ animation:none !important; }
    .wpp-button, .wpp-sheet, .wpp-cta { transition:none !important; }
  }